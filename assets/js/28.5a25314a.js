(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{421:function(e,t,r){"use strict";r.r(t);var a=r(5),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"set-up-a-production-environment"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#set-up-a-production-environment"}},[e._v("#")]),e._v(" Set up a production environment")]),e._v(" "),r("p",[e._v("Use the following information to set up and manage your production-level full Terra node. This information has been tested against RPM-based Linux distributions only.")]),e._v(" "),r("p",[e._v("For information about running a validator node, see "),r("RouterLink",{attrs:{to:"/How-to/validator/"}},[e._v("Validator Guide")]),e._v(".")],1),e._v(" "),r("h2",{attrs:{id:"create-a-dedicated-user"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#create-a-dedicated-user"}},[e._v("#")]),e._v(" Create a dedicated user")]),e._v(" "),r("p",[e._v("Although "),r("code",[e._v("terrad")]),e._v(" does not require a super user account, during the setup process you'll need super user permission to create and modify some files. In general, to run "),r("code",[e._v("terrad")]),e._v(", we strongly recommend using a normal user.")]),e._v(" "),r("h2",{attrs:{id:"increase-the-maximum-files-terrad-can-open"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#increase-the-maximum-files-terrad-can-open"}},[e._v("#")]),e._v(" Increase the maximum files "),r("code",[e._v("terrad")]),e._v(" can open")]),e._v(" "),r("p",[e._v("By default, "),r("code",[e._v("terrad")]),e._v(" is set to open 1024 files. However, we recommend you increase this amount.")]),e._v(" "),r("p",[e._v("Modify "),r("code",[e._v("/etc/security/limits.conf")]),e._v(" to increase the amount, where "),r("code",[e._v("nofile")]),e._v(" is the number of files "),r("code",[e._v("terrad")]),e._v(" can open.")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("*                soft    nofile          65535\n*                hard    nofile          65535\n")])])]),r("h2",{attrs:{id:"configure-the-firewall"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-firewall"}},[e._v("#")]),e._v(" Configure the firewall")]),e._v(" "),r("p",[r("code",[e._v("terrad")]),e._v(" uses the following TCP ports. Toggle their settings to fit your environment.")]),e._v(" "),r("ul",[r("li",[r("p",[r("code",[e._v("26656")]),e._v(": The default port for the P2P protocol. This port is used to communicate with other nodes and must be open to join a network. However, it does not have to be open to the public. For validator nodes, we recommend configuring "),r("code",[e._v("persistent_peers")]),e._v(" and closing this port to the public.")])]),e._v(" "),r("li",[r("p",[r("code",[e._v("26657")]),e._v(": The default port for the RPC protocol. Because this port is used for querying and sending transactions, it must be open for serving queries from "),r("code",[e._v("terrad")]),e._v(".")])])]),e._v(" "),r("div",{staticClass:"custom-block danger"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("Do not open this port to the public unless you plan to run a public node.")])]),e._v(" "),r("ul",[r("li",[r("p",[r("code",[e._v("1317")]),e._v(": The default port for the "),r("RouterLink",{attrs:{to:"/How-to/terrad/lcd.html"}},[e._v("Lite Client Daemon")]),e._v(" (LCD), which can be executed by "),r("code",[e._v("terrad rest-server")]),e._v(". The LCD provides an HTTP RESTful API layer to allow applications and services to interact with your "),r("code",[e._v("terrad")]),e._v(" instance through RPC. For usage examples, see "),r("a",{attrs:{href:"https://swagger.terra.money",target:"_blank",rel:"noopener noreferrer"}},[e._v("Terra REST API"),r("OutboundLink")],1),e._v(". You don't need to open this port unless you have use of it.")],1)]),e._v(" "),r("li",[r("p",[r("code",[e._v("26660")]),e._v(": The default port for interacting with the "),r("a",{attrs:{href:"https://prometheus.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("Prometheus"),r("OutboundLink")],1),e._v(" database, which can be used to monitor the environment. In the default configuration, this port is not open.")])])]),e._v(" "),r("h2",{attrs:{id:"run-the-server-as-a-daemon"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#run-the-server-as-a-daemon"}},[e._v("#")]),e._v(" Run the server as a daemon")]),e._v(" "),r("p",[r("code",[e._v("terrad")]),e._v(" must be running all the time. It can be kept running in several ways, but we recommend that you register "),r("code",[e._v("terrad")]),e._v(" as a "),r("code",[e._v("systemd")]),e._v(" service so that it will be started automatically when the system reboots and other events occur.")]),e._v(" "),r("h2",{attrs:{id:"register-terrad-as-a-service"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#register-terrad-as-a-service"}},[e._v("#")]),e._v(" Register terrad as a service")]),e._v(" "),r("ol",[r("li",[e._v("Create a service definition file in "),r("code",[e._v("/etc/systemd/system/terrad.service")]),e._v(", as shown in the following example:")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("[Unit]\nDescription=Terra Daemon\nAfter=network.target\n\n[Service]\nType=simple\nUser=terra\nExecStart=/data/terra/go/bin/terrad start\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\n\n[Service]\nLimitNOFILE=65535\n")])])]),r("ol",{attrs:{start:"2"}},[r("li",[r("p",[e._v("Modify the "),r("code",[e._v("Service")]),e._v(" section for your environment. Even if you raised the number of open files, you must include "),r("code",[e._v("LimitNOFILE")]),e._v(".")])]),e._v(" "),r("li",[r("p",[e._v("Run "),r("code",[e._v("systemctl daemon-reload")]),e._v(" and "),r("code",[e._v("systemctl enable terrad")]),e._v(".")])])]),e._v(" "),r("h2",{attrs:{id:"control-the-service"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#control-the-service"}},[e._v("#")]),e._v(" Control the service")]),e._v(" "),r("p",[e._v("Use "),r("code",[e._v("systemctl")]),e._v(" to start, stop, and restart the service.")]),e._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Start")]),e._v("\nsystemctl start terrad\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Stop")]),e._v("\nsystemctl stop terrad\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Restart")]),e._v("\nsystemctl restart terrad\n")])])]),r("h2",{attrs:{id:"access-logs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#access-logs"}},[e._v("#")]),e._v(" Access logs")]),e._v(" "),r("p",[e._v("Use "),r("code",[e._v("journalctl -t")]),e._v(" to access entire logs, entire logs in reverse, and the latest and continuous log.")]),e._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Entire log")]),e._v("\njournalctl -t terrad\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Entire log reversed")]),e._v("\njournalctl -t terrad -r\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Latest and continuous")]),e._v("\njournalctl -t terrad -f\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);