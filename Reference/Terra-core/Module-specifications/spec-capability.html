<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Capability | Terra Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/7420256/6416592/css/fonts.css">
    <link rel="stylesheet" type="text/css" href="https://www.terra.money/static/fonts/jetbrainsMono.css?updated=190220">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,500,700&amp;display=swap">
    <link rel="icon" type="image/png" href="/img/favicon.png">
    <script>window.onload = function() {
        requestAnimationFrame(function() {
          if (location.hash) {
            const element = document.getElementById(location.hash.slice(1))

            if (element) {
              element.scrollIntoView()
            }
          }
        })
      }</script>
    <meta name="description" content="Terra is an open source, public blockchain protocol that provides fundamental infrastructure for a decentralized economy and enables open participation in the creation of new financial primitives to power the innovation of money.">
    
    <link rel="preload" href="/assets/css/0.styles.f28a23c8.css" as="style"><link rel="preload" href="/assets/js/app.c84c9c01.js" as="script"><link rel="preload" href="/assets/js/3.f3fe07cb.js" as="script"><link rel="preload" href="/assets/js/36.066cf0b4.js" as="script"><link rel="prefetch" href="/assets/js/10.a0c5b63a.js"><link rel="prefetch" href="/assets/js/11.316e136d.js"><link rel="prefetch" href="/assets/js/12.67dc7619.js"><link rel="prefetch" href="/assets/js/13.ef4bfb66.js"><link rel="prefetch" href="/assets/js/14.7bf184b0.js"><link rel="prefetch" href="/assets/js/15.40db98a3.js"><link rel="prefetch" href="/assets/js/16.3419c9da.js"><link rel="prefetch" href="/assets/js/17.352b3a81.js"><link rel="prefetch" href="/assets/js/18.f3e13dab.js"><link rel="prefetch" href="/assets/js/19.0792326a.js"><link rel="prefetch" href="/assets/js/20.e77d79d9.js"><link rel="prefetch" href="/assets/js/21.3b9967f4.js"><link rel="prefetch" href="/assets/js/22.6c33ae4c.js"><link rel="prefetch" href="/assets/js/23.32292766.js"><link rel="prefetch" href="/assets/js/24.e54366a2.js"><link rel="prefetch" href="/assets/js/25.39ec2aea.js"><link rel="prefetch" href="/assets/js/26.9f04f8f3.js"><link rel="prefetch" href="/assets/js/27.90a4c429.js"><link rel="prefetch" href="/assets/js/28.fb15a121.js"><link rel="prefetch" href="/assets/js/29.601921d8.js"><link rel="prefetch" href="/assets/js/30.cb289f9f.js"><link rel="prefetch" href="/assets/js/31.e9a01dae.js"><link rel="prefetch" href="/assets/js/32.e6ee2d8f.js"><link rel="prefetch" href="/assets/js/33.be6bdac6.js"><link rel="prefetch" href="/assets/js/34.c96a4afc.js"><link rel="prefetch" href="/assets/js/35.009d14be.js"><link rel="prefetch" href="/assets/js/37.bd03e046.js"><link rel="prefetch" href="/assets/js/38.859a6d28.js"><link rel="prefetch" href="/assets/js/39.7f0ce8d3.js"><link rel="prefetch" href="/assets/js/4.589c6742.js"><link rel="prefetch" href="/assets/js/40.1c7df81f.js"><link rel="prefetch" href="/assets/js/41.ca2a4981.js"><link rel="prefetch" href="/assets/js/42.e62fa7a5.js"><link rel="prefetch" href="/assets/js/43.3f93fda3.js"><link rel="prefetch" href="/assets/js/44.732990dd.js"><link rel="prefetch" href="/assets/js/45.b7124f5a.js"><link rel="prefetch" href="/assets/js/46.45f9fa0d.js"><link rel="prefetch" href="/assets/js/47.321c9cc8.js"><link rel="prefetch" href="/assets/js/48.18feeb1f.js"><link rel="prefetch" href="/assets/js/49.2845046a.js"><link rel="prefetch" href="/assets/js/5.eb445fa1.js"><link rel="prefetch" href="/assets/js/50.fb3448b2.js"><link rel="prefetch" href="/assets/js/51.5cc9d7ca.js"><link rel="prefetch" href="/assets/js/52.8c262e58.js"><link rel="prefetch" href="/assets/js/53.642da94f.js"><link rel="prefetch" href="/assets/js/54.4cd719d4.js"><link rel="prefetch" href="/assets/js/55.71cfcb40.js"><link rel="prefetch" href="/assets/js/56.3c4a356e.js"><link rel="prefetch" href="/assets/js/57.81c76641.js"><link rel="prefetch" href="/assets/js/58.4e51ae06.js"><link rel="prefetch" href="/assets/js/59.00ff0d81.js"><link rel="prefetch" href="/assets/js/6.3691b753.js"><link rel="prefetch" href="/assets/js/60.a69b6577.js"><link rel="prefetch" href="/assets/js/61.af8af95c.js"><link rel="prefetch" href="/assets/js/62.ce0aacd9.js"><link rel="prefetch" href="/assets/js/63.3cfadd66.js"><link rel="prefetch" href="/assets/js/64.0a787ece.js"><link rel="prefetch" href="/assets/js/65.862c7dab.js"><link rel="prefetch" href="/assets/js/66.ae93bbfe.js"><link rel="prefetch" href="/assets/js/67.bfb54df2.js"><link rel="prefetch" href="/assets/js/7.b70b9284.js"><link rel="prefetch" href="/assets/js/8.75327833.js"><link rel="prefetch" href="/assets/js/9.76181f1a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.af4f3d85.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f28a23c8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"></div> <a href="/" class="home-link router-link-active"><img src="/img/docs_logo.svg" alt="Terra Docs" class="logo"> <span class="site-name can-hide">Terra Docs</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/Tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/How-to/" class="nav-link">How to</a></div><div class="nav-item"><a href="/Concepts/" class="nav-link">Concepts</a></div><div class="nav-item"><a href="/Reference/" class="nav-link router-link-active">Reference</a></div><div class="nav-item"><a href="https://github.com/terra-money/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav> <form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form></div></header> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/Tutorials/" class="nav-link">Tutorials</a></div><div class="nav-item"><a href="/How-to/" class="nav-link">How to</a></div><div class="nav-item"><a href="/Concepts/" class="nav-link">Concepts</a></div><div class="nav-item"><a href="/Reference/" class="nav-link router-link-active">Reference</a></div><div class="nav-item"><a href="https://github.com/terra-money/core" target="_blank" rel="noopener noreferrer" class="nav-link external"><div class="nav-icon"><img src="/img/github.svg"></div></a></div></nav>  <ul class="sidebar-links"><li><a href="/Reference/" aria-current="page" class="sidebar-link">Reference</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Terra core</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Reference/Terra-core/Overview.html" class="sidebar-link">Developer guide</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-auth.html" class="sidebar-link">Auth</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-authz.html" class="sidebar-link">AuthZ</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-bank.html" class="sidebar-link">Bank</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-capability.html" aria-current="page" class="active sidebar-link">Capability</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-capability.html#initialization" class="sidebar-link">Initialization</a></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-capability.html#concepts" class="sidebar-link">Concepts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-capability.html#stores" class="sidebar-link">Stores</a></li></ul></li><li class="sidebar-sub-header"><a href="/Reference/Terra-core/Module-specifications/spec-capability.html#states" class="sidebar-link">States</a></li></ul></li><li><a href="/Reference/Terra-core/Module-specifications/spec-distribution.html" class="sidebar-link">Distribution</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-evidence.html" class="sidebar-link">Evidence</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-feegrant.html" class="sidebar-link">Fee grant</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-governance.html" class="sidebar-link">Governance</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-market.html" class="sidebar-link">Market</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-mint.html" class="sidebar-link">Mint</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-oracle.html" class="sidebar-link">Oracle</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-slashing.html" class="sidebar-link">Slashing</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-staking.html" class="sidebar-link">Staking</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-treasury.html" class="sidebar-link">Treasury</a></li><li><a href="/Reference/Terra-core/Module-specifications/spec-wasm.html" class="sidebar-link">WASM</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>terrad</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Reference/integrations.html" class="sidebar-link">Integrations</a></li><li><a href="/Reference/ecosystem.html" class="sidebar-link">Ecosystem</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other resources</span> <span class="arrow right"></span></p> <!----></section></li></ul>  <div class="sidebar_footer"><a href="https://terra-money.github.io/terra-sdk-python/" target="_blank"><div class="image"><img src="https://www.terra.money/assets/img/terra_sdk.svg"></div> <div class="name"><div><b>Terra</b> Python SDK
          <i class="material-icons">transit_enterexit</i></div></div></a> <a href="https://terra-money.github.io/terra.js/" target="_blank"><div class="image"><img src="/img/terra_js.svg"></div> <div class="name"><div><b>Terra.js</b> JS SDK
          <i class="material-icons">transit_enterexit</i></div></div></a></div></aside> <main class="page"> <nav id="breadcrumb" class="breadcrumb-container" data-v-5c2bdde3><a href="/" class="breadcrumb router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Terra Docs</span></a><a href="/Reference/" class="breadcrumb router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Reference</span></a><a href="/Reference/Terra-core/Module-specifications/spec-capability.html" aria-current="page" class="breadcrumb router-link-exact-active router-link-active" data-v-5c2bdde3><span data-v-5c2bdde3>Capability</span></a></nav> <div class="theme-default-content content__default"><h1 id="capability"><a href="#capability" class="header-anchor">#</a> Capability</h1> <div class="custom-block warning"><p class="custom-block-title">NOTE</p> <p>Terra's capability module inherits from Cosmos SDK's <a href="https://docs.cosmos.network/v0.43/modules/capability/" target="_blank" rel="noopener noreferrer"><code>gov</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> module. This document is a stub, and covers mainly important Terra-specific notes about how it is used.</p></div> <p>The capability module allows you to provision, track, and authenticate multi-owner capabilities at runtime.</p> <p>The keeper maintains two states: persistent and ephemeral in-memory. The persistent state maintains a globally unique autoincrementing index and a map from the capability index to a set of capability owners that are defined as a module and a capability name tuple. The ephemeral in-memory state tracks the actual capabilities, represented as addresses in local memory, with both forward and reverse indexes. The forward index maps the module name and capability tuples to the capability name. The reverse index maps the module and capability name to the capability itself.</p> <p>The keeper allows the creation of scoped subkeepers, which are tied to a particular module by name. Scoped subkeepers must be created and passed to modules when you initialize the application. Then, the modules can use them to claim capabilities they receive and retrieve capabilities that they own by name. Additionally, they can create new capabilities and authenticate capabilities passed by other modules. A scoped subkeeper cannot escape its scope, so a module cannot interfere with or inspect capabilities owned by other modules.</p> <p>The keeper provides no other core functionality that can be found in other modules, such as queriers, REST and CLI handlers, and the genesis state.</p> <h2 id="initialization"><a href="#initialization" class="header-anchor">#</a> Initialization</h2> <p>When you initialize the application, the keeper must be instantiated with a persistent store key and an ephemeral in-memory store key.</p> <div class="language- extra-class"><pre class="language-text"><code>type App struct {
  // ...

  capabilityKeeper *capability.Keeper
}

func NewApp(...) *App {
  // ...

  app.capabilityKeeper = capability.NewKeeper(codec, persistentStoreKey, memStoreKey)
}
</code></pre></div><p>After the keeper is created, it can create scoped subkeepers, which are passed to other modules that can create, authenticate, and claim capabilities. After all the necessary scoped subkeepers are created and the state is loaded, you must initialize and seal the main capability keeper to populate the ephemeral in-memory state and to prevent more scoped subkeepers from being created.</p> <div class="language- extra-class"><pre class="language-text"><code>func NewApp(...) *App {
  // ...

  // Initialize and seal the capability keeper so all persistent capabilities
  // are loaded in-memory and prevent any further modules from creating scoped
  // sub-keepers.
  ctx := app.BaseApp.NewContext(true, tmproto.Header{})
  app.capabilityKeeper.InitializeAndSeal(ctx)

  return app
}
</code></pre></div><h2 id="concepts"><a href="#concepts" class="header-anchor">#</a> Concepts</h2> <p>Capabilities are multi-owner. A scoped subkeeper can create a capability via <code>NewCapability,</code> which creates a unique, unforgeable, object-capability reference. The newly created capability is automatically persisted. The calling module does not need to call <code>ClaimCapability</code>. Calling <code>NewCapability</code> creates the capability with the calling module and name as a tuple to be the capabilities first owner.</p> <p>Capabilities can be claimed by other modules, which add them as owners. <code>ClaimCapability</code> allows a module to claim a capability key that it has received from another module so that <code>GetCapability</code> calls made later will succeed. If a module that receives a capability wants to access it by name later, <code>ClaimCapability</code> must be called. Because capabilities are multi-owner, if multiple modules have one capability reference, all the modules own it. If a module receives a capability from another module but does not call <code>ClaimCapability</code>, it may use it in the executing transaction but will not be able to access it afterward.</p> <p>Any module can call <code>AuthenticateCapability</code> to check whether a capability corresponds to a particular name, including un-trusted user input, with which the calling module previously associated it.</p> <p><code>GetCapability</code> allows a module to fetch a capability that it has previously claimed by name. The module is not allowed to retrieve capabilities that it does not own.</p> <h3 id="stores"><a href="#stores" class="header-anchor">#</a> Stores</h3> <ul><li>MemStore</li></ul> <h2 id="states"><a href="#states" class="header-anchor">#</a> States</h2> <ul><li>Index</li> <li>CapabilityOwners</li> <li>Capability</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/terra-money/docs/edit/main/docs/Reference/Terra-core/Module-specifications/spec-capability.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Updated on:</span> <span class="time">10/7/2021, 6:14:58 PM</span></div></footer> <div class="page-nav"><div class="inner"><div class="prev"><a href="/Reference/Terra-core/Module-specifications/spec-bank.html">Bank</a></div> <div class="next"><a href="/Reference/Terra-core/Module-specifications/spec-distribution.html">Distribution</a></div></div></div>  <div class="footer-container"><div class="company"><div class="copyright">Terraform labs PTE.LTD</div> <div class="subscribe"><div class="subscribe-title">Subscribe to get updates</div> <form action="https://money.us17.list-manage.com/subscribe/post?u=8eca8dc5c91c2e30d69b1463e&id=1447662093" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" novalidate="novalidate" class="validate"><input type="email" value name="EMAIL" id="mce-EMAIL" placeholder="Email address" required="required" class="email">
        real people should not fill this in and expect good things - do not remove this or risk form bot
        signups
        <div aria-hidden="true" style="position: absolute; left: -5000px;"><input type="text" name="b_8eca8dc5c91c2e30d69b1463e_1447662093" tabindex="-1" value></div> <button type="submit">Submit</button></form></div></div> <div class="links-container"><ul class="learn"><li>Learn</li> <li><a href="https://www.terra.money/Terra_White_paper.pdf" target="_blank">
          White
          Paper
        </a></li> <li><a href="https://certik.org/projects/terra" target="_blank">Security Audit</a></li> <li><a href="https://agora.terra.money/" target="_blank">Agora Discussions</a></li></ul> <ul class="developers"><li>Tools</li> <li><a href="https://station.terra.money/" target="_blank">Terra Station</a></li> <li><a href="https://finder.terra.money/" target="_blank">Terra Finder</a></li> <li><a href="https://status.terra.money/" target="_blank">Status</a></li></ul> <ul class="developers"><li>Luna</li> <li><a href="https://docs.terra.money/Concepts/Luna.html" target="_blank">What is Luna?</a></li> <li><a href="https://docs.terra.money/Reference/integrations.html#exchanges" target="_blank">Exchanges</a></li> <li><a href="https://docs.terra.money/Reference/integrations.html#wallets" target="_blank">Wallets</a></li></ul> <ul class="developers"><li>Foundation</li> <li><a href="https://terra.breezy.hr/" target="_blank">Careers</a></li></ul> <ul class="developers"><li>Developers</li> <li><a href="https://github.com/terra-money" target="_blank">Github</a></li> <li><a href="https://docs.terra.money/" target="_blank">Documentation</a></li> <li><a href="https://docs.terra.money/#sdks-for-developers" target="_blank">SDKs</a></li> <li><a href="https://github.com/terra-money/TIPs" target="_blank">TIPs</a></li></ul> <ul class="developers"><li>Validators</li> <li><a href="https://docs.terra.money/How-to/Manage-a-Terra-validator/Overview.html" target="_blank">Validator Guide</a></li> <li><a href="https://github.com/terra-money/validator-profiles" target="_blank">Profiles</a></li> <li><a href="https://discord.gg/ZHBuKda" target="_blank">Discord Channel</a></li></ul></div> <div class="sns-container"><div class="logos"><a href="https://discord.gg/e29HWwC2Mz" rel="noopener" target="_blank"><img src="https://www.terra.money/static/assets/images/icon_discord.png" alt="link to Terra discord room"></a> <a href="https://medium.com/terra-money" rel="noopener" target="_blank"><img src="https://www.terra.money/static/assets/images/icon_medium.png" alt="link to Terra medium"></a> <a href="https://twitter.com/terra_money" rel="noopener" target="_blank"><img src="https://www.terra.money/static/assets/images/icon_twitter.png" alt="link to Terra twitter"></a> <a href="https://www.youtube.com/channel/UCoV1RXZ9ZBGcuu_PMTTlM0g" rel="noopener" target="_blank"><img src="https://www.terra.money/static/assets/images/icon_youtube.png" alt="link to Terra youtube"></a> <a href="https://t.me/terra_announcements" rel="noopener" target="_blank"><img src="https://www.terra.money/static/assets/images/icon_telegram.png" alt="link to Terra telegram room"></a></div> <a href="https://www.terra.money" target="_blank" class="terramoney">terra.money</a></div></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c84c9c01.js" defer></script><script src="/assets/js/3.f3fe07cb.js" defer></script><script src="/assets/js/36.066cf0b4.js" defer></script>
  </body>
</html>
